import { describe, it, expect } from '@jest/globals';

import { createApp } from '../app.js';

describe('Basic API Tests', () => {
  let app: any;

  beforeAll(() => {
    app = createApp();
  });

  it('should return 200 for health endpoint', async () => {
    const res = await app.request({
      method: 'GET',
      path: '/health'
    });

    expect(res.status).toBe(200);
    const json = await res.json();
    expect(json).toHaveProperty('status');
  });

  it('should return 200 for root endpoint', async () => {
    const res = await app.request({
      method: 'GET',
      path: '/'
    });

    expect(res.status).toBe(200);
    const json = await res.json();
    expect(json).toHaveProperty('status', 'ok');
  });

  it('should return 404 for non-existent route', async () => {
    const res = await app.request({
      method: 'GET',
      path: '/non-existent-route'
    });

    expect(res.status).toBe(404);
  });
});